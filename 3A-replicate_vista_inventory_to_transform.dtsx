<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="3/15/2024 10:13:34 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="UKWWHDSQLWI099"
  DTS:CreatorName="UK\PAM-WMS-Migration"
  DTS:DTSID="{A6F9FBE6-0E70-4541-B20C-5E332B06D24E}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5270.0"
  DTS:LocaleID="2057"
  DTS:ObjectName="3A-inventory-transform_inventory"
  DTS:PackageType="5"
  DTS:VersionBuild="117"
  DTS:VersionGUID="{4395D29C-B898-488D-951C-682C2E974CDE}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[DM_Working_DB]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{E3FA1844-8FEB-4411-A7D9-012A32E090BC}"
      DTS:ObjectName="DM_Working_DB">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=UKWWHDSQLWI099;Initial Catalog=DM_DryRun3_NP3;Provider=SQLNCLI11.1;Integrated Security=SSPI;Application Name=SSIS-3A-inventory-transform_inventory-{E3FA1844-8FEB-4411-A7D9-012A32E090BC}UKWWHDSQLWI099.DM_DryRun3_NP3;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{00738CA6-871A-4A90-9C21-E94DA8C3A49B}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="varRunID">
      <DTS:VariableValue
        DTS:DataType="2">1</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Replicate tables - run separately in order"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{CFDC2D46-B11C-442D-A10C-6E4DB96670C4}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Replicate tables - run separately in order">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Replicate tables - run separately in order\Replicate Vista Inventory Table to transform_vista_inventory"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{E8D5C1DD-D509-4A21-80B2-F0CFF550F5AD}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Replicate Vista Inventory Table to transform_vista_inventory"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{E3FA1844-8FEB-4411-A7D9-012A32E090BC}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE transform.vista_inventory;&#xA;WITH vendors AS (&#xA;SELECT v.Vendor&#xA;      ,v.[Binder Code]&#xA;&#x9;  --,v.vendor_idx&#xA;&#x9;  --,v.[Created On]&#xA;  FROM (&#xA;SELECT  ROW_NUMBER() OVER (PARTITION BY supp.[Binder Code] ORDER BY supp.Vendor DESC) AS vendor_idx&#xA;       ,supp.*&#xA;  FROM final.Vendors supp&#xA;  ) v WHERE v.vendor_idx = 1&#xA;)&#xA;INSERT INTO transform.vista_inventory&#xA;SELECT (fin.record_number/5000)+1 AS output_file_batch&#xA;       ,fin.*&#xA;  FROM (&#xA;SELECT ilv.*&#xA;      ,ROW_NUMBER() OVER (PARTITION BY NULL ORDER BY ilv.run_id) AS record_number&#xA;      ,COUNT(ilv.Isbn13) OVER (PARTITION BY NULL) AS dataset_count&#xA;      ,tit.PackSize&#xA;&#x9;  ,tit.country_of_origin&#xA;  FROM (&#xA;SELECT LTRIM(RTRIM(inv.[Isbn13])) + '-' + LTRIM(RTRIM(inv.[SupplyEd])) AS ISBN_SuppEd&#xA;      ,inv.[Isbn13]&#xA;      ,inv.[SupplyEd]&#xA;&#x9;  ,inv.[BaseLuType]&#xA;&#x9;  ,inv.[BaseLuId]&#xA;      ,inv.[LocationType]&#xA;      ,inv.[BookWeight]&#xA;&#x9;  ,inv.[binder]&#xA;&#x9;  ,vend.Vendor AS VendorID&#xA;      ,inv.[ID]&#xA;      ,inv.[RecSta]&#xA;      ,inv.[Site]&#xA;      ,inv.[Placement]&#xA;      ,inv.[Location]&#xA;      ,inv.[SegNumber]&#xA;      ,inv.[LuPerSegment]&#xA;      ,inv.[LuInSegment]&#xA;      ,inv.[LuAwaitIn]&#xA;      ,inv.[SegLuType]&#xA;      ,inv.[SegmentStatus]&#xA;      ,inv.[Isbn]&#xA;      ,inv.[ImpressionNo]&#xA;      ,inv.[ReceivedDate]&#xA;      ,inv.[BindOrderNo]&#xA;      ,inv.[DeliveryNo]&#xA;      ,inv.[ProductPrice]&#xA;      ,inv.[UnitSize]&#xA;      ,inv.[UnitWeight]&#xA;      ,inv.[BaseDimLong]&#xA;      ,inv.[BaseDimShort]&#xA;      ,inv.[UnitDimHigh]&#xA;      ,inv.[NoOfUnitsA]&#xA;      ,inv.[FrozenCodeA]&#xA;      ,inv.[UnitsAwIn1A]&#xA;      ,inv.[UnitsAwIn2A]&#xA;      ,inv.[UnitsAwIn3A]&#xA;      ,inv.[UnitsAwOut1A]&#xA;      ,inv.[UnitsAwOut2A]&#xA;      ,inv.[UnitsAwOut3A]&#xA;      ,inv.[NoOfUnitsB]&#xA;      ,inv.[FrozenCodeB]&#xA;      ,inv.[UnitsAwIn1B]&#xA;      ,inv.[UnitsAwIn2B]&#xA;      ,inv.[UnitsAwIn3B]&#xA;      ,inv.[UnitsAwOut1B]&#xA;      ,inv.[UnitsAwOut2B]&#xA;      ,inv.[UnitsAwOut3B]&#xA;      ,inv.[NoOfUnitsC]&#xA;      ,inv.[FrozenCodeC]&#xA;      ,inv.[UnitsAwIn1C]&#xA;      ,inv.[UnitsAwIn2C]&#xA;      ,inv.[UnitsAwIn3C]&#xA;      ,inv.[UnitsAwOut1C]&#xA;      ,inv.[UnitsAwOut2C]&#xA;      ,inv.[UnitsAwOut3C]&#xA;      ,inv.[NoOfUnitsD]&#xA;      ,inv.[FrozenCodeD]&#xA;      ,inv.[UnitsAwIn1D]&#xA;      ,inv.[UnitsAwIn2D]&#xA;      ,inv.[UnitsAwIn3D]&#xA;      ,inv.[UnitsAwOut1D]&#xA;      ,inv.[UnitsAwOut2D]&#xA;      ,inv.[UnitsAwOut3D]&#xA;      ,inv.[NoOfUnitsE]&#xA;      ,inv.[FrozenCodeE]&#xA;      ,inv.[UnitsAwIn1E]&#xA;      ,inv.[UnitsAwIn2E]&#xA;      ,inv.[UnitsAwIn3E]&#xA;      ,inv.[UnitsAwOut1E]&#xA;      ,inv.[UnitsAwOut2E]&#xA;      ,inv.[UnitsAwOut3E]&#xA;      ,inv.[NoOfUnitsF]&#xA;      ,inv.[FrozenCodeF]&#xA;      ,inv.[UnitsAwIn1F]&#xA;      ,inv.[UnitsAwIn2F]&#xA;      ,inv.[UnitsAwIn3F]&#xA;      ,inv.[UnitsAwOut1F]&#xA;      ,inv.[UnitsAwOut2F]&#xA;      ,inv.[UnitsAwOut3F]&#xA;      ,inv.[OpenedDate]&#xA;      ,inv.[NoOfAccesses]&#xA;      ,inv.[LastTransferDate]&#xA;      ,inv.[LastTransferQty]&#xA;      ,inv.[CiCountIn]&#xA;      ,inv.[CiCountOut]&#xA;      ,inv.[CiCountDate]&#xA;      ,inv.[CiCountTotal]&#xA;      ,inv.[CiCountAdjust]&#xA;      ,inv.[PiCountIn]&#xA;      ,inv.[PiCountOut]&#xA;      ,inv.[PiCountDate]&#xA;      ,inv.[PiCountTotal]&#xA;      ,inv.[PiCountAdjust]&#xA;      ,inv.[GbsManifest]&#xA;      ,inv.[GbsSpare]&#xA;      ,inv.[HoldUnitSize]&#xA;      ,inv.[HoldUnitWeight]&#xA;      ,inv.[HoldDimLong]&#xA;      ,inv.[HoldDimShort]&#xA;      ,inv.[HoldDimHigh]&#xA;      ,inv.[FullPalletExtr]&#xA;      ,inv.[PiCountRequested]&#xA;      ,inv.[PiCountQcCheck]&#xA;      ,inv.[FreeLocnFlag]&#xA;      ,inv.[TransferDate]&#xA;      ,inv.[MiscSpare]&#xA;      ,inv.[CumulativeAccesses]&#xA;      ,inv.[PiGeneratedDate]&#xA;      ,inv.[Shippable]&#xA;      ,inv.[InProgress]&#xA;      ,inv.[PickAccessSta]&#xA;      ,inv.[ReplAccessSta]&#xA;      ,inv.[ReleaseWhenEmpty]&#xA;      ,inv.[BindPickPackExcl]&#xA;      ,inv.[run_id]&#xA;      ,inv.[replace_location_if_not_setup]&#xA;      ,fil.main_tag_starter&#xA;      ,fil.by_payload_filler&#xA;      ,fil.main_tag_finisher&#xA;  FROM [source].[vista_inventory] inv&#xA;  JOIN config.data_element_payload_fillers fil ON fil.data_element_name = 'inventory' &#xA;  LEFT OUTER JOIN vendors vend ON vend.[Binder Code] = inv.binder&#xA;) ilv&#xA;    JOIN final.titles tit ON tit.ISBN_SuppEd = ilv.ISBN_SuppEd ) fin&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="364,42.6666666666667"
          Id="Package\Replicate tables - run separately in order\Replicate Vista Inventory Table to transform_vista_inventory"
          TopLeft="237.386908084065,162.020050489593" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1042,540"
          Size="1042,582.666666666667"
          Id="Package\Replicate tables - run separately in order"
          TopLeft="39.7500028498465,87.7719308806034" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>